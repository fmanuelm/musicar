{"ast":null,"code":"import { ClientsService } from '../service/clients.service';\nimport jsPDF from \"jspdf\";\nimport autoTable from 'jspdf-autotable';\nimport * as FileSaver from \"file-saver\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/clients.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"primeng/table\";\nimport * as i4 from \"primeng/api\";\n\nfunction DataTableComponent_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 2)(2, \"div\", 17)(3, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_ng_template_14_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.exportExcel());\n    });\n    i0.ɵɵtext(4, \" Excel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function DataTableComponent_ng_template_14_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.exportExcel());\n    });\n    i0.ɵɵtext(6, \" PDF \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 20)(8, \"span\", 21)(9, \"input\", 22);\n    i0.ɵɵlistener(\"input\", function DataTableComponent_ng_template_14_Template_input_input_9_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      i0.ɵɵnextContext();\n\n      const _r0 = i0.ɵɵreference(13);\n\n      return i0.ɵɵresetView(_r0.filterGlobal($event.target.value, \"contains\"));\n    });\n    i0.ɵɵelementEnd()()()()();\n  }\n}\n\nfunction DataTableComponent_ng_template_15_th_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"p-sortIcon\", 25);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const col_r11 = ctx.$implicit;\n    i0.ɵɵproperty(\"pSortableColumn\", col_r11.field);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", col_r11.header, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"field\", col_r11.field);\n  }\n}\n\nfunction DataTableComponent_ng_template_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, DataTableComponent_ng_template_15_th_1_Template, 3, 3, \"th\", 23);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const columns_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", columns_r9);\n  }\n}\n\nfunction DataTableComponent_ng_template_16_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const col_r15 = ctx.$implicit;\n    const rowData_r12 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", rowData_r12[col_r15.field], \" \");\n  }\n}\n\nfunction DataTableComponent_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, DataTableComponent_ng_template_16_td_1_Template, 2, 1, \"td\", 26);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const columns_r13 = ctx.columns;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", columns_r13);\n  }\n}\n\nfunction DataTableComponent_ng_template_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"button\", 27);\n  }\n}\n\nconst _c0 = function () {\n  return [\"razon_social\", \"razon_comercial\", \"nit\", \"tipo_cliente\"];\n};\n\nexport let DataTableComponent = /*#__PURE__*/(() => {\n  class DataTableComponent {\n    constructor(clientService) {\n      this.clientService = clientService;\n      this.first = 0;\n      this.cols = [{\n        field: 'razon_social',\n        header: 'Razón social'\n      }, {\n        field: 'razon_comercial',\n        header: 'Razón comercial'\n      }, {\n        field: 'nit',\n        header: 'NIT'\n      }, {\n        field: 'tipo_cliente',\n        header: 'Tipo cliente'\n      }, {\n        field: 'paises.nombre',\n        header: 'País'\n      }];\n    }\n\n    ngOnInit() {\n      this.getClients();\n      this.exportColumns = this.cols.map(col => ({\n        title: col.header,\n        dataKey: col.field\n      }));\n    }\n\n    getClients() {\n      this.clientService.getClients().subscribe(resp => {\n        // this.clients = resp;\n        console.log('desde el componente', resp);\n      });\n    }\n\n    exportPdf() {\n      const datos = this.clients.map(cliente => {\n        return {\n          razon_social: cliente.razon_social,\n          razon_comercial: cliente.razon_comercial,\n          nit: cliente.nit,\n          tipo_cliente: cliente.tipo_cliente,\n          pais: cliente.paises\n        };\n      });\n      const exportColumns = this.cols.map(col => ({\n        title: col.header,\n        dataKey: col.field\n      }));\n      const doc = new jsPDF('p', 'pt');\n      autoTable(doc, {\n        columns: exportColumns,\n        body: datos,\n        didDrawPage: dataArg => {\n          doc.text('clientes', dataArg.settings.margin.left, datos.length);\n        }\n      });\n      doc.save(`clientes.pdf`);\n    }\n\n    exportExcel() {\n      const datos = this.clients.map(cliente => {\n        return {\n          razon_social: cliente.razon_social,\n          razon_comercial: cliente.razon_comercial,\n          nit: cliente.nit,\n          tipo_cliente: cliente.tipo_cliente,\n          pais: cliente.pais.nombre\n        };\n      });\n      import('xlsx').then(xlsx => {\n        const worksheet = xlsx.utils.json_to_sheet(datos);\n        const workbook = {\n          Sheets: {\n            'data': worksheet\n          },\n          SheetNames: ['data']\n        };\n        const excelBuffer = xlsx.write(workbook, {\n          bookType: 'xlsx',\n          type: 'array'\n        });\n        this.saveAsExcelFile(excelBuffer, 'clientes');\n      });\n    }\n\n    saveAsExcelFile(buffer, fileName) {\n      let EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n      let EXCEL_EXTENSION = '.xlsx';\n      const data = new Blob([buffer], {\n        type: EXCEL_TYPE\n      });\n      FileSaver.saveAs(data, fileName + '_export_' + new Date().getTime() + EXCEL_EXTENSION);\n    }\n\n  }\n\n  DataTableComponent.ɵfac = function DataTableComponent_Factory(t) {\n    return new (t || DataTableComponent)(i0.ɵɵdirectiveInject(i1.ClientsService));\n  };\n\n  DataTableComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DataTableComponent,\n    selectors: [[\"app-data-table-cmp\"]],\n    decls: 18,\n    vars: 7,\n    consts: [[1, \"main-content\"], [1, \"container-fluid\"], [1, \"row\"], [1, \"col-md-12\"], [1, \"card\"], [1, \"card-header\", \"card-header-primary\", \"card-header-icon\"], [1, \"card-title\"], [1, \"card-body\"], [1, \"toolbar\"], [1, \"material-datatables\"], [\"id\", \"tableClients\", 3, \"globalFilterFields\", \"columns\", \"value\", \"paginator\", \"rows\", \"first\"], [\"tableClients\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"paginatorcenter\"], [1, \"flex\"], [1, \"col\"], [1, \"btn\", \"btn-success\", \"mr-2\", 3, \"click\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"col\", \"d-flex\", \"flex-row-reverse\"], [1, \"p-input-icon-left\", \"ml-auto\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Global seach\", 3, \"input\"], [3, \"pSortableColumn\", 4, \"ngFor\", \"ngForOf\"], [3, \"pSortableColumn\"], [3, \"field\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", \"pButton\", \"\", \"icon\", \"pi-cloud-upload\"]],\n    template: function DataTableComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"h2\", 6)(7, \"b\");\n        i0.ɵɵtext(8, \" Listar clientes \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(9, \"div\", 7);\n        i0.ɵɵelement(10, \"div\", 8);\n        i0.ɵɵelementStart(11, \"div\", 9)(12, \"p-table\", 10, 11);\n        i0.ɵɵtemplate(14, DataTableComponent_ng_template_14_Template, 10, 0, \"ng-template\", 12);\n        i0.ɵɵtemplate(15, DataTableComponent_ng_template_15_Template, 2, 1, \"ng-template\", 13);\n        i0.ɵɵtemplate(16, DataTableComponent_ng_template_16_Template, 2, 1, \"ng-template\", 14);\n        i0.ɵɵtemplate(17, DataTableComponent_ng_template_17_Template, 1, 0, \"ng-template\", 15);\n        i0.ɵɵelementEnd()()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"globalFilterFields\", i0.ɵɵpureFunction0(6, _c0))(\"columns\", ctx.cols)(\"value\", ctx.clients)(\"paginator\", true)(\"rows\", 10)(\"first\", ctx.first);\n      }\n    },\n    dependencies: [i2.NgForOf, i3.Table, i4.PrimeTemplate, i3.SortableColumn, i3.SortIcon],\n    encapsulation: 2\n  });\n  return DataTableComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}